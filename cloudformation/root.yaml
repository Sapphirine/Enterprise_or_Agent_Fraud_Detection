# nested stack - root
AWSTemplateFormatVersion: "2010-09-09"
Description: Fraud detection pipeline cloudformation code
Parameters:
  SrcBucketUrl:
    Description: Bucket location to put s3 buckets
    Default: https://eecs6895-fraud-detection-repo.s3.amazonaws.com
    Type: String
  SrcBucketName:
    Type: String
    Default: eecs6895-fraud-detection-repo
    Description: Bucket that hosts all src files

Resources:
  VpcStack:
    Type: AWS::CloudFormation::Stack
    Properties:
      # hardcode s3 bucket
      TemplateURL: !Sub ${Description}/cloudformation/vpc.yaml
  IamRoleStack:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: !Sub ${Description}/cloudformation/iam_role.yaml
#  ApiLambdaStack:
#    Type: AWS::CloudFormation::Stack
#    Properties:
#      TemplateURL: !Sub ${Description}/cloudformation/api_lambda.yaml

Outputs:
  VPCStackRef:
    Value: !Ref VpcStack
  VPCIDRef:
    Value: !GetAtt
      - VpcStack
      - Outputs.VPCID
  PublicSubnetARef:
    Value: !GetAtt
      - VpcStack
      - Outputs.PublicSubnetA
  PublicSubnetBRef:
    Value: !GetAtt
      - VpcStack
      - Outputs.PublicSubnetB
  PrivateSubnetARef:
    Value: !GetAtt
      - VpcStack
      - Outputs.PrivateSubnetA
  PrivateSubnetBRef:
    Value: !GetAtt
      - VpcStack
      - Outputs.PrivateSubnetB
  SecurityGroup1IdRef:
    Value: !GetAtt
      - VpcStack
      - Outputs.SecurtityGroup1